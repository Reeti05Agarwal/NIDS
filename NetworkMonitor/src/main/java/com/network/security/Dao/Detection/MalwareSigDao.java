// package com.network.security.Dao.Detection;

// import java.sql.Connection;
// import java.sql.PreparedStatement;
// import java.sql.ResultSet;
// import java.sql.SQLException;
// import java.util.ArrayList;
// import java.util.List;

// import com.network.security.Intrusion_detection.MalwareSigDetection;

// public class MalwareSigDao {
//     private MalwareSigDetection malwareSigDetection;

//     // Insert a new brute force detection rule into the database
//     public void insertMalwareSigDetection(Connection conn) {
//         String sql = "INSERT INTO malformed_packet_signatures (signature) VALUES (?)";
//         try (PreparedStatement stmt = conn.prepareStatement(sql)) {
//             for (String signature : malwareSigDetection.getMalwareSignature()) {
//                 stmt.setString(1, signature);
//                 stmt.executeUpdate();
//             }
//         } catch (SQLException e) {
//             System.err.println("[ERROR] Failed to insert brute force detection rule");
//             e.printStackTrace();
//         }
//     }

//     // Load the brute force detection thresholds from the database
//     public void loadMalwareSigDetection(Connection conn, String name) {
//         String sql = "SELECT check_type, expected_value, field, severity FROM malformed_packet_signatures WHERE name = ?";
//         try (PreparedStatement stmt = conn.prepareStatement(sql)) {
//             stmt.setString(1, name);
//             ResultSet rs = stmt.executeQuery();

//             while (rs.next()) {
//                 malwareSigDetection.getCheckTypeMS(rs.getString("check_type"));
//                 malwareSigDetection.getPatternMS(rs.getString("expected_value"));
//                 malwareSigDetection.getFieldMS(rs.getString("field"));
//                 malwareSigDetection.setSeverity(rs.getString("severity"));
//             }
            
//         } catch (SQLException e) {
//             System.err.println("[ERROR] Failed to load brute force thresholds");
//             e.printStackTrace();
//         }
//     }

//     // update check_type
//     public void updateMalwareSigDetectionCheck(Connection conn, String check_type, int id) {
//         String sql = "UPDATE malformed_packet_signatures SET check_type = ? WHERE id = ?";
//         try (PreparedStatement stmt = conn.prepareStatement(sql)) {
//             stmt.setString(1, check_type);
//             stmt.setInt(2, id);
//             stmt.executeUpdate();
//         } catch (SQLException e) {
//             System.err.println("[ERROR] Failed to update brute force detection rule");
//             e.printStackTrace();
//         }
//     }

//     // update expected_value
//     public void updateMalwareSigDetectionEV(Connection conn, String expected_value, int id) {
//         String sql = "UPDATE malformed_packet_signatures SET expected_value = ? WHERE id = ?";
//         try (PreparedStatement stmt = conn.prepareStatement(sql)) {
//             stmt.setString(1, expected_value);
//             stmt.setInt(2, id);
//             stmt.executeUpdate();
//         } catch (SQLException e) {
//             System.err.println("[ERROR] Failed to update brute force detection rule");
//             e.printStackTrace();
//         }
//     }

//     // update field
//     public void updateMalwareSigDetectionField(Connection conn, String field, int id) {
//         String sql = "UPDATE malformed_packet_signatures SET field = ? WHERE id = ?";
//         try (PreparedStatement stmt = conn.prepareStatement(sql)) {
//             stmt.setString(1, field);
//             stmt.setInt(2, id);
//             stmt.executeUpdate();
//         } catch (SQLException e) {
//             System.err.println("[ERROR] Failed to update brute force detection rule");
//             e.printStackTrace();
//         }
//     }


//     // delete
//     public void deleteMalwareSigDetection(Connection conn, int id) {
//         String sql = "DELETE FROM malformed_packet_signatures WHERE id = ?";
//         try (PreparedStatement stmt = conn.prepareStatement(sql)) {
//             stmt.setInt(1, id);
//             stmt.executeUpdate();
//         } catch (SQLException e) {
//             System.err.println("[ERROR] Failed to delete brute force detection rule");
//             e.printStackTrace();
//         }
//     }

// }
